<html>
<head><title>bingo party</title></head>
<body>

    <h2><span id="connected">0</span> users are on this page right now.</h2>

    <h3>what is your favorite city?</h3>

    <form method="post" action="#" id="cityform">
        <label>City</label>
        <input type="text" id="city"/>
        <input type="submit" value="Submit"/>
    </form>

    <input id="logout" type="submit" value="Logout"/>
    <input id="bc1" type="submit" value="Buy 1 card"/>
    <input id="bc2" type="submit" value="Buy 2 card"/>
    <div id="cities-list"></div>
    <div id="room-list"></div>

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js"></script>

    <script type="text/javascript">

        $(document).ready(function() {

            var socket = io.connect("http://52.53.44.20:8026");

            socket.on('auth', function(msg) {
                socket.emit('auth', {'uid': 1, 'device':'duid_3e375fe3ab9f609828930044a1dcb37a66443957'});
            });

            socket.on('unauth', function(msg) {
                console.log('un auth');
            });

            socket.on('login', function(msg) {
                console.log('uid: '+ msg.uid);
            });

            socket.on('msg', function(msg) {
                $("#connected").html(msg.count);
            });

            socket.on('cities', function(msg) {
                console.log(msg);
                var s = '';
                for (var key in msg) {
                    s += '<p>' + key + ': ' + msg[key] + '</p>';
                }
                $("#cities-list").html(s);
            });

            socket.on('room', function(msg) {
                console.log(msg);
                var s = '';
                for (var key in msg) {
                    s += '<p>' + key + '</p>';
                }
                $("#room-list").html(s);
            });

            $("#cityform").submit(function(event) {
                socket.emit('city', {'city': $('#city').val()});
                $('#city').val('');
                return false;
            });

            $("#logout").click(function() {
                socket.emit('logout', {});
            });

            $("#bc1").click(function() {
                socket.emit('buycard', {'cards': 1});
            });

            $("#bc2").click(function() {
                socket.emit('buycard', {'cards': 2});
            });
        });

    </script>
</body>
</html>
